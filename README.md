# Инструкция по установке CA

## 0. Удаление предыдущей версии пакета (если установлена)

```bash
sudo apt purge myapp-asta
```

## 1. Получение нужных файлов

Скачайте из репозитория пакет myapp_gunicorn_psql_deb.deb и скрипт инсталяции installer.sh и поместите их в одну папку и перейдите в неё.

## 2. Выдача прав

Перейдите в командную строку и выдайте скрипту installer.sh права на исполнение:
```bash
sudo chmod +x installer.sh
```

## 3. Запуск инсталятора

Запустите скрипт инсталяции:
```bash
sudo ./installer.sh
```

## 4. Настройка репозиториев

После запуска скрипта необходимо выбрать как именно реадиктировать системный файл Astra.

> Примечание: В случае если у вас версия Astra 1.7 рекомендуется выбрать автоматическую настройку, иначе в том числе при возникновении ошибок доступа к репозиториям рекомендуется ручная установка.

## 4.1. Ручная настройка репозиториев

Откройте файл sources.list для редактирования:
```bash
sudo nano /etc/apt/sources.list
```

Убедитесь, что в файле присутствуют следующие **активные** строки (без символа #):
```
deb https://download.astralinux.ru/astra/stable/1.7_x86-64/repository-main/ 1.7_x86-64 main contrib non-free
deb https://download.astralinux.ru/astra/stable/1.7_x86-64/repository-update/ 1.7_x86-64 main contrib non-free
deb https://download.astralinux.ru/astra/stable/1.7_x86-64/repository-base/ 1.7_x86-64 main contrib non-free
deb https://download.astralinux.ru/astra/stable/1.7_x86-64/repository-extended/ 1.7_x86-64 main contrib non-free
```

И **закомментирована** строка с CD:
```
#deb cdrom:[OS Astra Linux 1.7.5 1.7_x86-64 DVD ]/ 1.7_x86-64 contrib main non-free
```
> Примечание 1: Пути могут отличатся в зависимости от версии Astra, которую Вы используете.
> 
> Примечание 2: В случае если это не так - отредактируйте файл и зажмите Ctrl+O, затем Enter и Ctrl+X.

## 5. Загрузка и генерация библиотек бикрипта

Во время установки потребуется указать абсолютный путь до папки в которой лежат заголовочные файлы bcry.h и errors.h, а так же папка Linux внутри которой лежат файлы libbicr5_64.so и libbiogrn.so.

Пример:

```
/path/to/bicript/
├── bcry.h
├── errors.h
└── Linux/
    ├── libbicr5_64.so
    └── libbiogrn.so
```

## 6. Настройка базы данных

Во время установки потребуется указать:
- Имя пользователя PostgreSQL
- Пароль пользователя
- Имя базы данных

> Примечание: Если пользователь уже существует, указанный пароль будет обновлен.

## 7. Проверка работоспособности

Откройте в веб-браузере:
```
http://localhost
```

---

**Важно!** Все команды должны выполняться с правами root (через sudo).
